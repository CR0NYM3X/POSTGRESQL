
### **Conocer las diferencias clave entre Oracle y PostgreSQL**
Antes de migrar, es fundamental entender c√≥mo difieren:

| Aspecto | Oracle | PostgreSQL |
|--------|--------|------------|
| Tipos de datos | Muy espec√≠ficos (e.g. `NUMBER`, `VARCHAR2`) | M√°s est√°ndar (e.g. `NUMERIC`, `VARCHAR`) |
| Procedimientos | PL/SQL | PL/pgSQL |
| Secuencias | `SEQUENCE`, `TRIGGERS` para autoincremento | `SERIAL`, `BIGSERIAL`, `IDENTITY` |
| Funciones | Paquetes, funciones, procedimientos | Funciones (con o sin retorno) |
| Particiones | Avanzadas, con subtipos | Mejoradas desde PG 10+ |
| √çndices | Bitmap, Function-based, etc. | B-tree, GIN, GiST, BRIN |
| Seguridad | Roles, perfiles, auditor√≠a | Roles, pol√≠ticas, RLS, extensiones |

 
## üß≠ 1. √çndice

1.  Objetivo
2.  Requisitos
3.  ¬øQu√© es ora2pg?
4.  Ventajas y Desventajas
5.  Casos de uso
6.  Simulaci√≥n de empresa y problema
7.  Estructura sem√°ntica
8.  Visualizaci√≥n t√©cnica
9.  Procedimiento completo
    *   Instalaci√≥n de ora2pg
    *   Conexi√≥n a Oracle
    *   Exportaci√≥n de esquema
    *   Migraci√≥n de datos
    *   Validaci√≥n y ajustes
10. Consideraciones finales
11. Buenas pr√°cticas
12. Recomendaciones
13. Bibliograf√≠a

***

## üéØ 2. Objetivo

Este manual tiene como objetivo guiarte paso a paso en la migraci√≥n de una base de datos Oracle a PostgreSQL utilizando la herramienta **ora2pg**, simulando un entorno real de empresa, con comandos ejecutables, configuraciones y visualizaciones t√©cnicas.

***

## üß∞ 3. Requisitos

*   Conocimientos b√°sicos de Oracle y PostgreSQL
*   Herramientas como "Oracle SQL Developer"  y PgAdmin
*   Acceso a una base de datos Oracle (puede ser local o remota)
*   PostgreSQL instalado (versi√≥n 13+ recomendada)
*   Sistema operativo Linux (Ubuntu/Debian/CentOS)
*   Perl instalado (ora2pg est√° escrito en Perl)
*   Conexi√≥n de red entre Oracle y el host donde se ejecuta ora2pg
*   Usuario con privilegios de lectura en Oracle

***

## ‚ùì 4. ¬øQu√© es ora2pg?

**ora2pg** es una herramienta de c√≥digo abierto que permite migrar esquemas, datos y funciones desde Oracle a PostgreSQL. Convierte autom√°ticamente objetos como tablas, √≠ndices, secuencias, vistas, funciones PL/SQL, triggers, etc.

***

## ‚öñÔ∏è 5. Ventajas y Desventajas

**Ventajas:**

*   Automatiza gran parte del proceso
*   Compatible con grandes vol√∫menes de datos
*   Permite migraciones parciales
*   Genera reportes de compatibilidad

**Desventajas:**

*   No convierte todo el PL/SQL complejo
*   Requiere ajustes manuales en funciones y triggers
*   No migra paquetes ni procedimientos almacenados complejos sin intervenci√≥n

***


## ‚úÖ **¬øQu√© s√≠ hace Ora2Pg?**

1. **Extrae estructuras de Oracle**:
   - Tablas, √≠ndices, secuencias, vistas, sin√≥nimos, constraints, etc.
2. **Convierte tipos de datos Oracle a PostgreSQL**.
3. **Migra datos** (opcional, puedes exportar solo estructura o estructura + datos).
4. **Convierte funciones y procedimientos PL/SQL a PL/pgSQL** (con limitaciones).
5. **Genera scripts SQL listos para ejecutar en PostgreSQL**.
6. **Eval√∫a el esfuerzo de migraci√≥n** (modo `migration assessment`).
7. **Soporta migraci√≥n de particiones, triggers, grants, y m√°s**.
8. **Permite personalizar la migraci√≥n con filtros y configuraciones avanzadas**.

---

## ‚ùå **¬øQu√© no hace Ora2Pg?**

| Limitaci√≥n | Detalle |
|------------|---------|
| üîß **No convierte todo el c√≥digo PL/SQL complejo** | Procedimientos muy complejos, paquetes, cursores anidados, excepciones personalizadas, etc., pueden requerir **reescritura manual**. |
| üì¶ **No migra paquetes (`PACKAGE`) ni tipos definidos por el usuario (`OBJECT TYPE`)** | Estos deben migrarse manualmente o con herramientas adicionales. |
| üîÑ **No mantiene l√≥gica de negocio 100% funcional** | Algunas funciones pueden comportarse diferente en PostgreSQL. Se requiere **validaci√≥n y pruebas**. |
| üîê **No migra usuarios, roles ni privilegios de forma completa** | Solo puede exportar algunos `GRANT`, pero no gestiona usuarios ni contrase√±as. |
| üß© **No migra dependencias externas** | Jobs de Oracle (DBMS_SCHEDULER), enlaces a otras bases (`DBLINK`), integraciones con otros sistemas, etc., deben manejarse aparte. |
| üß† **No optimiza autom√°ticamente el rendimiento en PostgreSQL** | La estructura migrada puede necesitar **ajustes de √≠ndices, particiones, estad√≠sticas, etc.** |
| üìä **No migra reportes, formularios ni aplicaciones Oracle Forms/Reports** | Solo trabaja con la base de datos, no con herramientas externas. |

---

## üõ†Ô∏è ¬øQu√© puedes usar junto con Ora2Pg?

- **SQL Developer**: Para exportar objetos complejos o revisar dependencias.
- **pgAdmin / DBeaver**: Para importar y validar en PostgreSQL.
- **Scripts personalizados**: Para migrar usuarios, jobs, o l√≥gica no soportada.
- **Testing automatizado**: Para validar que los resultados en PostgreSQL sean correctos.

## üè¢ 6. Simulaci√≥n de empresa y problema

**Empresa:** AgroTech Sinaloa\
**Problema:** La empresa tiene un sistema de gesti√≥n de cultivos en Oracle 11g y desea migrarlo a PostgreSQL para reducir costos y mejorar la integraci√≥n con herramientas modernas.

***
 

## üõ†Ô∏è 8. Procedimiento completo

### üîπ Instalaci√≥n de ora2pg

```bash
sudo apt update
sudo apt install ora2pg -y

#Instalar DBI
 apt-get install cpanminus 
cpanm DBI 

#Instalar DBD::Oracle y DBD::Pg
 cpanm DBD::Oracle 
cpanm DBD::Pg 

#Instalar ora2pg
 tar xjf ora2pg-xxtar.bz2 
cd ora2pg-xx/ 
perl Makefile.PL 
make && make install

```

### üîπ Configuraci√≥n de conexi√≥n a Oracle

Editamos el archivo de configuraci√≥n:

```bash
sudo nano /etc/ora2pg/ora2pg.conf
```

Configuramos:

```ini 
ORACLE_DSN = localhost:1521/ORCL -- - dbi:Oracle:host=10.0.1.2;sid=DB_SID;port=1522
ORACLE_USER = oracle_user
ORACLE_PWD = oracle_password

PG_DSN = localhost:5432/postgres --- dbi:Pg:dbname=ora2pg_db;host=10.23.14.50;port=5432
PG_USER = postgres_user
PG_PWD = postgres_password

EXPORT_SCHEMA = YES
EXPORT_DATA = YES
TYPE = TABLE


```



### üîπ Simulaci√≥n de esquema en Oracle

Supongamos que tenemos esta tabla:

```sql
CREATE TABLE cultivos (
    id NUMBER PRIMARY KEY,
    nombre VARCHAR2(100),
    fecha_siembra DATE,
    hectareas NUMBER
);
```

### üîπ Exportaci√≥n del esquema

```bash
ora2pg -c /etc/ora2pg/ora2pg.conf -t TABLE -o cultivos.sql
```

**Simulaci√≥n de salida:**

```sql
CREATE TABLE cultivos (
    id integer PRIMARY KEY,
    nombre varchar(100),
    fecha_siembra date,
    hectareas numeric
);
```

### üîπ Migraci√≥n de datos

```bash
ora2pg -c /etc/ora2pg/ora2pg.conf -t COPY -o cultivos_data.sql
```

**Simulaci√≥n de salida:**

```sql
COPY cultivos (id, nombre, fecha_siembra, hectareas) FROM stdin;
1   Ma√≠z    2023-03-15  12.5
2   Trigo   2023-04-01  8.0
\.
```

### üîπ Importaci√≥n en PostgreSQL

```bash
psql -U postgres -d agrotech_db -f cultivos.sql
psql -U postgres -d agrotech_db -f cultivos_data.sql
```

### üîπ Validaci√≥n

```sql
SELECT * FROM cultivos;
```

**Simulaci√≥n de salida:**

| id | nombre | fecha\_siembra | hectareas |
| -- | ------ | -------------- | --------- |
| 1  | Ma√≠z   | 2023-03-15     | 12.5      |
| 2  | Trigo  | 2023-04-01     | 8.0       |

***

## ‚úÖ 9. Consideraciones

*   Verifica compatibilidad de tipos de datos
*   Revisa funciones PL/SQL manualmente
*   Usa `EXPORT_TYPE` para migrar por partes (TABLE, VIEW, FUNCTION, etc.)

***

## üß† 10. Buenas pr√°cticas

*   Realiza pruebas en entorno de staging
*   Usa control de versiones para scripts generados
*   Documenta cada paso de la migraci√≥n

***

## üí° 11. Recomendaciones


 # La opci√≥n `-t SHOW_REPORT`
se utiliza para **generar un informe detallado del an√°lisis de una base de datos Oracle antes de migrarla a PostgreSQL**. Este informe no realiza ninguna migraci√≥n, sino que **eval√∫a el esfuerzo necesario** para llevar a cabo la migraci√≥n.

### ¬øQu√© incluye el reporte generado por `ora2pg -t SHOW_REPORT`?

El informe muestra:

- **N√∫mero de objetos** en la base de datos Oracle (tablas, vistas, funciones, procedimientos, triggers, etc.).
- **Compatibilidad** de esos objetos con PostgreSQL.
- **Estimaci√≥n del esfuerzo** de migraci√≥n (en puntos de complejidad).
- **Problemas potenciales** como tipos de datos incompatibles, funciones PL/SQL que requieren reescritura, etc.
- **Recomendaciones** para ajustar la configuraci√≥n de ora2pg antes de iniciar la migraci√≥n real.

### ¬øPara qu√© sirve?

Este comando es ideal para:

- **Auditor√≠a previa** a la migraci√≥n.
- **Planificaci√≥n del proyecto** de migraci√≥n.
- **Identificaci√≥n de obst√°culos t√©cnicos**.
- **Estimaci√≥n de tiempos y recursos** necesarios.

### Ejemplo de uso:

```bash
ora2pg -t SHOW_REPORT -c /etc/ora2pg/ora2pg.conf
ora2pg -t SHOW_REPORT -c ora2pg.conf --dump_as_html | Set-Content -Path "report.html" -Encoding utf8

```

***

---
# Extra info

## üõ† ¬øC√≥mo usa ora2pg el CDC?

Ora2pg puede usar **LogMiner** para leer los redo logs y extraer los cambios. Esto requiere:

- Activar `ARCHIVELOG`.
- Configurar `SUPPLEMENTAL LOGGING`.
- Otorgar permisos para acceder a vistas como `V$LOGMNR_CONTENTS`.

Pero **no es en tiempo real**. Ora2pg puede ejecutar un proceso que:

1. Se conecta a Oracle.
2. Lee los logs desde un punto anterior.
3. Extrae los cambios.
4. Genera archivos `.sql` para aplicar en PostgreSQL.

Este proceso puede **automatizarse con cron o scripts**, pero no es una replicaci√≥n continua como lo har√≠a una herramienta de streaming.

 
---
# objetos que forman parte del esquema y la estructura de la base de datos Oracle


### üîπ **Objetos de almacenamiento**
- **Tables**: Almacenan datos estructurados.
- **Indexes**: Mejoran el rendimiento de las consultas.
- **Materialized Views**: Vistas que almacenan datos f√≠sicamente.
- **Clusters**: Agrupan tablas que comparten columnas comunes.
- **Partitions**: Dividen tablas grandes en partes m√°s manejables.


### üîπ **Objetos de programaci√≥n**
- **Procedures**: Bloques de c√≥digo PL/SQL que realizan tareas espec√≠ficas.
- **Functions**: Similar a los procedimientos, pero devuelven un valor.
- **Packages**: Agrupan procedimientos, funciones y variables relacionadas.
- **Triggers**: Ejecutan c√≥digo autom√°ticamente ante eventos DML o DDL.
- **Types**: Definen tipos de datos personalizados (usados en objetos y colecciones).
- **Libraries**: Referencias a c√≥digo externo (por ejemplo, C).


### üîπ **Objetos de seguridad**
- **Users**: Cuentas de acceso a la base de datos.
- **Roles**: Conjuntos de permisos que se pueden asignar a usuarios.
- **Profiles**: Configuran l√≠mites y pol√≠ticas de uso para usuarios.
- **Synonyms**: Alias para objetos de base de datos.
- **Grants**: Permisos otorgados sobre objetos.


### üîπ **Objetos de metadatos y administraci√≥n**
- **Schemas**: Colecciones de objetos propiedad de un usuario.
- **Tablespaces**: Espacios f√≠sicos de almacenamiento.
- **Sequences**: Generan valores num√©ricos √∫nicos (usados en claves primarias).
- **Database Links**: Conexiones a otras bases de datos Oracle.
- **Jobs**: Tareas programadas (usando DBMS_SCHEDULER o DBMS_JOB).


### üîπ **Objetos de consulta y vista**
- **Views**: Consultas guardadas como objetos reutilizables.
- **Synonyms**: Alias para acceder a objetos sin usar el nombre completo.
- **Cursors**: Permiten recorrer resultados de una consulta.


### üîπ **Objetos XML y JSON**
- **XMLType**: Tipo de dato para almacenar XML.
- **JSON Data**: Desde Oracle 12c, soporte nativo para JSON.


### üîπ **Otros objetos**
- **Directories**: Referencias a ubicaciones del sistema de archivos.
- **External Tables**: Tablas que leen datos desde archivos externos.
- **Object Types**: Tipos definidos por el usuario para programaci√≥n orientada a objetos.

---
# links
```
Ora2Pg tool introduction -> https://pankajconnect.medium.com/ora2pg-tool-introduction-48253d06d889

01 - Standard Operating Procedure (SOP) Oracle to PostgreSQL Migration using Ora2Pg -> https://medium.com/@jramcloud1/01-standard-operating-procedure-sop-oracle-to-postgresql-migration-using-ora2pg-7a5d5a36dd8b
02 - Oracle to PostgreSQL Migration with Ora2Pg -> https://medium.com/@jramcloud1/02-oracle-to-postgresql-migration-with-ora2pg-8a99591eb918

Why Migrate from Oracle to PostgreSQL -> https://medium.com/@abdelhaak/why-migrate-from-oracle-to-postgresql-9634fb82439c
Oracle to PostgreSQL Migration using Ora2Pg ‚ÄúPart 1‚Äù -> https://medium.com/@abdelhaak/hands-on-lab-migrating-your-oracle-database-to-postgresql-with-ora2pg-ab2c89b1d5ec
Oracle to PostgreSQL Migration using Ora2Pg ‚ÄúPart 2‚Äù -> https://medium.com/@abdelhaak/migrating-your-oracle-database-to-postgresql-with-ora2pg-hands-on-lab-part-2-c0ba8b471bcb 
Oracle to PostgreSQL Migration using Ora2Pg ‚ÄúPart 3‚Äù -> https://medium.com/@abdelhaak/migrating-your-oracle-database-to-postgresql-with-ora2pg-hands-on-lab-part-3-76e547f39b96

DMS | Oracle to PostgreSQL- Part 1 of 4 -> https://blog.searce.com/dms-oracle-to-postgresql-part-1-of-4-ae853f2ccc35
DMS | Oracle to PostgreSQL ‚Äî Part 2 of 4 -> https://blog.searce.com/dms-oracle-to-postgresql-part-2-of-4-d88799c5f9a
DMS | Oracle to PostgreSQL - Part 3 of 4 -> https://blog.searce.com/dms-oracle-to-postgresql-part-3-of-4-4342c8864d73
DMS | Oracle to PostgreSQL ‚Äî Part 4 of 4 -> https://blog.searce.com/dms-oracle-to-postgresql-part-4-of-4-49ea8effd1c0




Case Study: Migrating from Oracle 19c to PostgreSQL 16 using Ora2PG -> https://medium.com/@datapatrolt/case-study-migrating-from-oracle-19c-to-postgresql-16-using-ora2pg-a0ef2dde81cc
Oracle to Postgres : The Database Darwinism -> https://drunkdba.medium.com/oracle-to-postgres-the-database-darwinism-194390c5833d
Ora2pg GCP  -> https://technoshow91.medium.com/ora2pg-1d108fe10821

Important Ora2pg config variables -> https://medium.com/@abhijitgm5/configure-your-ora2pg-config-file-b82f7f46f6c5
migrate-oracle-postgres-using-ora2pg -> https://github.com/GoogleCloudPlatform/community/blob/master/archived/migrate-oracle-postgres-using-ora2pg/index.md

Oracle DB migration to Azure Database for Postgres (PG) -> https://medium.com/@chbasani/oracle-db-migration-to-azure-database-for-postgres-pg-69ee8ce34e07
Oracle to Postgres Migration Guide for Azure -> https://techcommunity.microsoft.com/blog/adforpostgresql/new-oracle-to-postgres-migration-guide-for-azure/2055303

*   <https://ora2pg.darold.net/>
*    https://github.com/darold/ora2pg
*   <https://www.postgresql.org/docs/>
*   <https://www.enterprisedb.com/>


```




 


